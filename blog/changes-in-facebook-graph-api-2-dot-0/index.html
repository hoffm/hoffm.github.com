
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Facebook Graph API v2.0: What's Changed? - Code Worrier</title>
  <meta name="author" content="Michael Hoffman">

  
  <meta name="description" content="Facebook recently introduced major changes to its Graph API.
Despite the existence of an official upgrade guide, these changes have caused
a
lot
of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://code-worrier.com/blog/changes-in-facebook-graph-api-2-dot-0/">
  <link href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB8HQH4/B0B+PwdAfj8HQH4/B0B+Mp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB8HQH4/B0B+PwdAfj8HQH4/B0B+PwdAfj8HQH4yn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQfB0B+PwdAfjKfUFQfB0B+Mp9QVB8HQH4/B0B+Mp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUHwdAfj8HQH4yn1BUHwdAfjKfUFQfB0B+PwdAfjKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB8HQH4/B0B+Mp9QVB8HQH4yn1BUHwdAfj8HQH4yn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQfB0B+PwdAfjKfUFQSn1BUEp9QVB8HQH4/B0B+Mp9QVBKfUFQSn1BUHwdAfj8HQH4/B0B+PwdAfj8HQH4yn1BUHwdAfj8HQH4yn1BUEp9QVBKfUFQfB0B+PwdAfjKfUFQSn1BUHwdAfj8HQH4/B0B+PwdAfj8HQH4/B0B+PwdAfjKfUFQfB0B+Mp9QVBKfUFQSn1BUHwdAfjKfUFQSn1BUEp9QVB8HQH4/B0B+Mp9QVBKfUFQSn1BUHwdAfj8HQH4yn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQfB0B+PwdAfjKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUHwdAfj8HQH4yn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB8HQH4/B0B+Mp9QVBKfUFQSn1BUHwdAfj8HQH4yn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQfB0B+PwdAfj8HQH4/B0B+PwdAfj8HQH4/B0B+Mp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB8HQH4/B0B+PwdAfj8HQH4/B0B+Mp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVBKfUFQSn1BUEp9QVB//8AAP+DAAD/AQAA/ykAAP8pAAD/KQAA/zkAAME5AACAuwAAnP8AAJ//AACf/wAAnP8AAID/AADB/wAA//8AAA==" rel="icon" type="image/x-icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Code Worrier" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34049294-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Code Worrier</a></h1>
  
    <h2>Teaching myself to RTFM</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:code-worrier.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Facebook Graph API v2.0: What's Changed?</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-29T15:00:00-04:00" pubdate data-updated="true">May 29<span>th</span>, 2014</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="left" src="/images/Open_Graph_protocol_logo.png" title="Open Graph Logo" >
Facebook recently introduced major changes to its <a href="https://developers.facebook.com/docs/graph-api/reference/v2.0">Graph API</a>.
Despite the existence of an official <a href="https://developers.facebook.com/docs/games/migrate">upgrade guide</a>, these changes have caused
<a href="http://stackoverflow.com/questions/23400204/get-facebook-friends-with-graph-api-v-2-0/">a</a>
<a href="http://stackoverflow.com/questions/23435961/fetching-list-of-friends-using-facebook-2-0">lot</a>
<a href="http://stackoverflow.com/questions/23836869/facebook-request-dialog-returning-invalid-user-ids">of</a>
<a href="http://stackoverflow.com/questions/23417356/facebook-graph-api-v2-0-me-friends-returns-empty-or-only-friends-who-also-use-m">confusion</a>
for some developers,Â myself among them.
In this post, I explore in detail the key differences between v1.0 and v2.0 of the API that cause the most frustration.
In a follow-up post, I will discuss how to use v2.0 to build some common features involving finding and inviting Facebook friends.</p>

<!-- more -->


<h3>Less User Data</h3>

<p>The updated Graph API is more restrictive in the data it makes available via the <a href="https://developers.facebook.com/docs/graph-api/reference/v2.0/user/"><code>/user</code></a> and <a href="https://developers.facebook.com/docs/graph-api/reference/v2.0/user/friends/"><code>/user/friends</code></a> endpoints.
More specifically, the new API provides data that is scoped to the client application:</p>

<ul>
<li>Global user ids have been replaced with application-specific ids.</li>
<li>Friend data is restricted to friends that have connected to the client application.</li>
</ul>


<p>I&#8217;ll address each of these restrictions in turn.</p>

<h3>Application-Specific IDs</h3>

<p>In the simpler days of v1.0, when the Graph API reported on a user, the id value it provided was a global id number for that Facebook user.
These values were &#8220;global&#8221; in the sense that they could be shared between client applications.
In v2.0, all user data provided by the <code>/user</code> endpoint and its children use application-specific ids.
These ids are a unique identifier not just of the Facebook user, but of the client-user pair.
This mean that you can&#8217;t share user ids between applications.
(Though Facebook does <a href="https://developers.facebook.com/docs/apps/for-business">provide an API</a> for mapping between applications that are part of single organization.)</p>

<p>An important consequence of this fact is that the user ids recognized by the Facebook applications you use for development will not match the ones your production app recognizes.
So, if you store your users&#8217; Facebook ids in your database in production, you won&#8217;t be able to match up users in that database with data returned from the API in development.
That&#8217;s annoying!</p>

<p>And there&#8217;s no way around it.
You&#8217;ll just have to query for a few of your friends from the development app and manually overwrite their stored Facebook ids in your development database.
This will give you a few exemplars to develop against.</p>

<h3>Application-Specific Friends</h3>

<p>The <code>user/friends</code> endpoint used to return exactly what you&#8217;d expect: a list of the user&#8217;s Facebook friends.
Not so in v2.0!
Instead, you&#8217;ll get a list of the user&#8217;s Facebook friends <em>who have connected to your client application at some point in the past</em>.
This is an enormous difference.
In v2.0 <em>there is no way to get a list of rich data about each of a user&#8217;s friends</em>.
You can&#8217;t even get their ids, app-specific or otherwise.</p>

<p>If you&#8217;re upgrading from v1.0 to v2.0, there&#8217;s another wrinkle:
If a user has <em>ever</em> connected to your app using version 2.0, strict permissions govern the data you get back no matter what version you specify in the API call.
Put another way, <em>once a user connects using the new API, all v1.0 requests are interpreted by Facebook as v2.0 requests</em>.
This means you need to be careful when deploying an upgrade to your integration with Facebook.
Once v2.0 login is live, there&#8217;s no going back for those users who connect with it.</p>

<h3>But Don&#8217;t Despair!</h3>

<p>Facebook made these adjustments to give its users more control over their data.
Under the new regime, Facebook data can&#8217;t easily be shared between applications.
While this can be frustrating for developers, it&#8217;s probably a good thing for users.</p>

<p>More importantly for our purposes: Despite the restrictions, it&#8217;s still possible to build many common features that make use of this data.
In an upcoming post, I&#8217;ll walk through several of them, including &#8220;finding friends&#8221;: surfacing a user&#8217;s Facebook friends who are already users of your client application.</p>

<hr />

<p><strong>Update, May 31, 2014</strong>: <a href="https://twitter.com/EmilHesslow">Emil Hesslow</a>, an engineer at Facebook, has pointed out to me that the &#8220;Test App&#8221; feature, which was introduced on April 30, 2014 along with the new version of the API, and which allows you to nest development applications under a production application, has a nice property that I glossed over:</p>

<blockquote><p>If you create a new Test app (a feature we added in v2.0) for your production app they will share the same app scoped user ids. You can read about them <a href="https://developers.facebook.com/docs/apps/test-apps">here</a>.</p></blockquote>

<p>Although I&#8217;d been using this feature, I hadn&#8217;t realized that it allowed test applications to share ids with production applications.
My production app was still running under v1.0, so I had global ids stored in my production database.
However, my test application was running v2.0 (as I was working on the upgrade) and received app-specific ids from the API.
Thus I could not develop against a dump of the production database without manually altering the Facebook ids that were stored for my application&#8217;s users.</p>

<p>I actually think my case is by far the most common one, for now at least.
The vast magority of Facebook applications were created before April 30th, 2014, and are therefore governed by pre-v2.0 rules.
However, all nested test apps were necessarily created after that date, which leads to the id mismatch.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Michael Hoffman</span></span>

      








  


<time datetime="2014-05-29T15:00:00-04:00" pubdate data-updated="true">May 29<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/api/'>api</a>, <a class='category' href='/blog/categories/facebook/'>facebook</a>, <a class='category' href='/blog/categories/graph/'>graph</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://code-worrier.com/blog/changes-in-facebook-graph-api-2-dot-0/" data-via="hoffm" data-counturl="http://code-worrier.com/blog/changes-in-facebook-graph-api-2-dot-0/" >Tweet</a>
  
  
  <div class="g-plusone" data-size=""></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/3-ways-to-cope-with-being-stuck-coding/" title="Previous Post: How to be Stuck: 3 Coping Techniques">&laquo; How to be Stuck: 3 Coping Techniques</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Who writes this?</h1>
  <ul id="recent_posts">
      <li class="post">
        <a href="http://michaelshoffman.com/">Michael Hoffman</a>
        does.
      </li>
      <li class="post">
        <a href="http://twitter.com/hoffm" class="twitter-follow-button" data-show-count="false">Follow @hoffm</a>
      </li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/changes-in-facebook-graph-api-2-dot-0/">Facebook Graph API v2.0: What's Changed?</a>
      </li>
    
      <li class="post">
        <a href="/blog/3-ways-to-cope-with-being-stuck-coding/">How to be Stuck: 3 Coping Techniques</a>
      </li>
    
      <li class="post">
        <a href="/blog/on-text-encoding/">On Text Encoding</a>
      </li>
    
      <li class="post">
        <a href="/blog/git-bisect-basics/">Git Bisect: Your Friend in Times of Need</a>
      </li>
    
      <li class="post">
        <a href="/blog/git-checkout-dash/">How to checkout the last git branch you were on</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Michael Hoffman -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'codeworrier';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://code-worrier.com/blog/changes-in-facebook-graph-api-2-dot-0/';
        var disqus_url = 'http://code-worrier.com/blog/changes-in-facebook-graph-api-2-dot-0/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
